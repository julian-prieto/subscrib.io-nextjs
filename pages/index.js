import Head from "next/head";
import { SubscriptionList, SubscriptionSummary } from "components";
import { useAuth } from "hooks";
import { useState } from "react";
import { EMPTY_FIELD } from "utils";

const Subscrib = () => {
  const { LoginButton, user } = useAuth();
  const [convertToCurrency, setConvertToCurrency] = useState();
  const handleChangeCurrency = (event) => {
    const currency = event.target.value;
    if (currency === EMPTY_FIELD) {
      setConvertToCurrency();
      return;
    }
    setConvertToCurrency(currency);
  };

  return (
    <>
      <Head>
        <title>Subscrib.io</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      {user ? (
        <>
          <select value={convertToCurrency} onChange={handleChangeCurrency}>
            <option value={EMPTY_FIELD}>{EMPTY_FIELD}</option>
            <option value="USD">USD</option>
            <option value="EUR">EUR</option>
            <option value="ARS">ARS</option>
          </select>
          <SubscriptionList convertToCurrency={convertToCurrency} />
          <SubscriptionSummary convertToCurrency={convertToCurrency} />
        </>
      ) : (
        <div style={{ display: "flex", gap: "2rem", flexDirection: "column", alignItems: "center" }}>
          <div>Login to see your dashboard</div>
          <LoginButton />
        </div>
      )}
    </>
  );
};

export default Subscrib;
